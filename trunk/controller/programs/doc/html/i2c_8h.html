<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ERAEmbeddedRobotArmProject: i2c.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>i2c.h File Reference</h1>Basic I2C communication layer. <a href="#_details">More...</a>
<p>
<code>#include &quot;<a class="el" href="utility_8h-source.html">utility.h</a>&quot;</code><br>

<p>
<a href="i2c_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#402bb5d5784be135d171382ddfa9d875">I2C_MODEFLAGS</a>&nbsp;&nbsp;&nbsp;0x28</td></tr>

<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a></td></tr>

<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#5f4c95c491d2bcd3f057f1f806fd2b9b">i2c_open_serial</a> (const char *device, unsigned long baud, unsigned long timeoutmiliseconde)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#0a0899cff28209e408335bcdf9e05b67">i2c_close_serial</a> (<a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a> <a class="el" href="libcan_8c.html#3127ebf018e9da62fa464d348352037d">handle</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#b642f96451ed8e84d29fdbd1542315a6">i2c_write</a> (<a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a> <a class="el" href="libcan_8c.html#3127ebf018e9da62fa464d348352037d">handle</a>, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> mod_addr, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> mod_reg, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#9688a1eff9c2d1a250dc63494f3deba8">i2c_read</a> (<a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a> <a class="el" href="libcan_8c.html#3127ebf018e9da62fa464d348352037d">handle</a>, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> mod_addr, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> mod_reg, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *value)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#c0dd14b96fda6899e52924cc0a3dede4">i2c_waitup</a> (<a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a> <a class="el" href="libcan_8c.html#3127ebf018e9da62fa464d348352037d">handle</a>, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> mod_addr, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> mod_reg, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> mask)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8h.html#e4115ff1e2b7a7d24610f14473e3dddd">i2c_waitdown</a> (<a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a> <a class="el" href="libcan_8c.html#3127ebf018e9da62fa464d348352037d">handle</a>, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> mod_addr, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> mod_reg, <a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> mask)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Basic I2C communication layer. 
<p>
<h2>Introduction</h2>
<p>
This layer provides basic mechanisms for communicating with ASL's I2C modules using a translator connected to a serial port. Use the function <a class="el" href="i2c_8c.html#5f4c95c491d2bcd3f057f1f806fd2b9b">i2c_open_serial()</a> to obtain a file descriptor of the serial port, and the functions <a class="el" href="i2c_8c.html#9688a1eff9c2d1a250dc63494f3deba8">i2c_read()</a> and <a class="el" href="i2c_8c.html#b642f96451ed8e84d29fdbd1542315a6">i2c_write()</a> for low-level communication.<p>
<h2>How to use I2C modules and drivers</h2>
<p>
The I2C Hardware modules plug into the little I2C plug on the robot's I/O circuitry. I2C is a bus, that means modules can be chained, which is why each of them has two I2C connectors.<p>
The I2C drivers are organized into two levels: The basic abstraction is provided by <a class="el" href="i2c_8h.html">i2c.h</a> (this file) and higher level drivers, each corresponding to one of the I2C hardware modules. The i2c_trans.h module is a little special: It corresponds to the bridge that translates RS232 to I2C, which provides some supplementary functionality and appears on the bus like any external I2C module.<p>
Whereas interaction with the base driver requires a valid <em>file descriptor</em>, higher levels use <em>objects</em> to store the information needed for their operation. Thus, each high-level module has a <code>i2c_X_init()</code> function, which usually takes three parameters: <ul>
<li>
<code>int fd</code>: The file descriptor from <a class="el" href="i2c_8c.html#5f4c95c491d2bcd3f057f1f806fd2b9b">i2c_open_serial()</a>.  </li>
<li>
<code>uint8 offset</code>: The offset from the module's default address (valid for ASL modules). It is needed if you plug two or more modules of the same kind into the bus, in which case the offset depends on jumper settings of each module. You can normally use 0.  </li>
<li>
<code>struct i2c_X_s *s</code>: A pointer to an object of the corresponding type. The object has to be allocated by the calling program, and this function is a constructor for correctly initializing the data structure.  </li>
</ul>
<p>
<h3>Base Driver</h3>
<p>
This module is needed for two things: <ul>
<li>
Initialize and clean up the serial port. </li>
<li>
Facilitate custom protocols or extensions of high-level drivers. </li>
</ul>
<p>
The first role being the most important: <em>You have to get a filedescriptor from <a class="el" href="i2c_8c.html#5f4c95c491d2bcd3f057f1f806fd2b9b">i2c_open_serial()</a> before you can initialize any high-level driver</em>.<p>
<h3>Module-specific Drivers</h3>
<p>
You'll probably use the base <a class="el" href="i2c_8h.html">i2c.h</a> layer only for opening and closing the file descriptor, and rely on one of the higher level drivers: <ul>
<li>
Serial to I2C converter: i2c_trans.h  </li>
<li>
Linear camera: i2c_lincam.h  </li>
<li>
Servo motors: i2c_servo.h  </li>
<li>
Analog sharp IR distance sensors: i2c_ansharp.h  </li>
<li>
Digital sharp IR distance sensors: i2c_digsharp.h  </li>
<li>
Ultrasound distance sensor: i2c_usound.h  </li>
</ul>
<p>
There also exists some test programs (in the <code>util/</code> subdirectory) which can be used to familiarize yourself e.g. with the I2C modules. Apart from the examples provided in the subdirectory of the same name, these test programs might be good starting pointd for your programs. <hr><h2>Define Documentation</h2>
<a class="anchor" name="402bb5d5784be135d171382ddfa9d875"></a><!-- doxytag: member="i2c.h::I2C_MODEFLAGS" ref="402bb5d5784be135d171382ddfa9d875" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define I2C_MODEFLAGS&nbsp;&nbsp;&nbsp;0x28          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Address of the modeflags register, common to all I2C modules and thus defined here. 
</div>
</div><p>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="5ad7d32f3a1ddabdc2933223ca6ce2ea"></a><!-- doxytag: member="i2c.h::handle_t" ref="5ad7d32f3a1ddabdc2933223ca6ce2ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int <a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="0a0899cff28209e408335bcdf9e05b67"></a><!-- doxytag: member="i2c.h::i2c_close_serial" ref="0a0899cff28209e408335bcdf9e05b67" args="(handle_t handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i2c_close_serial           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a>&nbsp;</td>
          <td class="paramname"> <em>handle</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close the serial port (after flushing).<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd><ul>
<li>
If error -1 occurs, the file descriptor is not closed.  </li>
</ul>
</dd></dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>
0 : success  </li>
<li>
-1 : couldn't drain port  </li>
<li>
-2 : couldn't flush port  </li>
<li>
-3 : couldn't close port  </li>
</ul>
</dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>handle</em>&nbsp;</td><td>
filedescriptor of serial port </td></tr>
</table>
</dl>
</div>
</div><p>
<a class="anchor" name="5f4c95c491d2bcd3f057f1f806fd2b9b"></a><!-- doxytag: member="i2c.h::i2c_open_serial" ref="5f4c95c491d2bcd3f057f1f806fd2b9b" args="(const char *device, unsigned long baud, unsigned long timeoutmiliseconde)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a> i2c_open_serial           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>baud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&nbsp;</td>
          <td class="paramname"> <em>timeoutmiliseconde</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Open the serial port to which the translator circuit is attached. Possible baud rates are<p>
<ul>
<li>
50  </li>
<li>
75  </li>
<li>
110  </li>
<li>
134  </li>
<li>
150  </li>
<li>
200  </li>
<li>
300  </li>
<li>
600  </li>
<li>
1200  </li>
<li>
1800  </li>
<li>
2400  </li>
<li>
4800  </li>
<li>
9600  </li>
<li>
19200  </li>
<li>
38400  </li>
<li>
57600  </li>
<li>
115200  </li>
<li>
230400  </li>
</ul>
<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd><ul>
<li>
Baud rates 115200 and 230400, when given as constants in your C sourcecode, need to be specified as "115200L" and "230400L". Without the trailing "L", the compiler might not treat those large numbers correctly. </li>
<li>
On Smartease, device is "/dev/tts/0" (or maybe "/dev/tts/1", depending on the hardware version). </li>
</ul>
</dd></dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>
&gt;=0 : openend filedescriptor  </li>
<li>
-1 : couldn't open port  </li>
<li>
-2 : couldn't clear termios structure  </li>
<li>
-3 : couldn't flush port  </li>
<li>
-4 : couldn't set port attributes  </li>
<li>
-5 : invalid baud rate  </li>
</ul>
</dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>device</em>&nbsp;</td><td>
device file filesystem emtry </td></tr>
<tr><td valign="top"><em>baud</em>&nbsp;</td><td>
wanted baud rate </td></tr>
<tr><td valign="top"><em>timeoutmiliseconde</em>&nbsp;</td><td>
wanted time out in ms </td></tr>
</table>
</dl>
</div>
</div><p>
<a class="anchor" name="9688a1eff9c2d1a250dc63494f3deba8"></a><!-- doxytag: member="i2c.h::i2c_read" ref="9688a1eff9c2d1a250dc63494f3deba8" args="(handle_t handle, uint8 mod_addr, uint8 mod_reg, uint8 *value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i2c_read           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a>&nbsp;</td>
          <td class="paramname"> <em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>mod_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>mod_reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Read a register of an I2C module.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd><ul>
<li>
Only the 7 least significant bits of mod_addr and mod_reg are used.  </li>
</ul>
</dd></dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>
0 : success  </li>
<li>
-1 : error sending the read request  </li>
<li>
-2 : couldn't drain port  </li>
<li>
-3 : error receiving the answer  </li>
<li>
-4 : read timeout  </li>
</ul>
</dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>handle</em>&nbsp;</td><td>
file descriptor </td></tr>
<tr><td valign="top"><em>mod_addr</em>&nbsp;</td><td>
i2c address of module </td></tr>
<tr><td valign="top"><em>mod_reg</em>&nbsp;</td><td>
address of register inside module </td></tr>
<tr><td valign="top"><em>value</em>&nbsp;</td><td>
the value of the register (if success) </td></tr>
</table>
</dl>
</div>
</div><p>
<a class="anchor" name="e4115ff1e2b7a7d24610f14473e3dddd"></a><!-- doxytag: member="i2c.h::i2c_waitdown" ref="e4115ff1e2b7a7d24610f14473e3dddd" args="(handle_t handle, uint8 mod_addr, uint8 mod_reg, uint8 mask)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i2c_waitdown           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a>&nbsp;</td>
          <td class="paramname"> <em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>mod_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>mod_reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>mask</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Wait (indefinetely) for (any) bit of a register to become 0 without sleeping (busy wait).<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>
0 : success  </li>
<li>
&lt;0 : same as <a class="el" href="i2c_8c.html#9688a1eff9c2d1a250dc63494f3deba8">i2c_read()</a>  </li>
</ul>
</dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>handle</em>&nbsp;</td><td>
file descriptor </td></tr>
<tr><td valign="top"><em>mod_addr</em>&nbsp;</td><td>
i2c address of module </td></tr>
<tr><td valign="top"><em>mod_reg</em>&nbsp;</td><td>
address of register inside module </td></tr>
<tr><td valign="top"><em>mask</em>&nbsp;</td><td>
defines the bits to wait for </td></tr>
</table>
</dl>
</div>
</div><p>
<a class="anchor" name="c0dd14b96fda6899e52924cc0a3dede4"></a><!-- doxytag: member="i2c.h::i2c_waitup" ref="c0dd14b96fda6899e52924cc0a3dede4" args="(handle_t handle, uint8 mod_addr, uint8 mod_reg, uint8 mask)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i2c_waitup           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a>&nbsp;</td>
          <td class="paramname"> <em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>mod_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>mod_reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>mask</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Wait (indefinetely) for (any) bit of a register to become 1 without sleeping (busy wait).<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Add a timeout.</dd></dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>
0 : success  </li>
<li>
&lt;0 : same as <a class="el" href="i2c_8c.html#9688a1eff9c2d1a250dc63494f3deba8">i2c_read()</a>  </li>
</ul>
</dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>handle</em>&nbsp;</td><td>
file descriptor </td></tr>
<tr><td valign="top"><em>mod_addr</em>&nbsp;</td><td>
i2c address of module </td></tr>
<tr><td valign="top"><em>mod_reg</em>&nbsp;</td><td>
address of register inside module </td></tr>
<tr><td valign="top"><em>mask</em>&nbsp;</td><td>
defines the bits to wait for </td></tr>
</table>
</dl>
</div>
</div><p>
<a class="anchor" name="b642f96451ed8e84d29fdbd1542315a6"></a><!-- doxytag: member="i2c.h::i2c_write" ref="b642f96451ed8e84d29fdbd1542315a6" args="(handle_t handle, uint8 mod_addr, uint8 mod_reg, uint8 value)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i2c_write           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="i2c_8h.html#5ad7d32f3a1ddabdc2933223ca6ce2ea">handle_t</a>&nbsp;</td>
          <td class="paramname"> <em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>mod_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>mod_reg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>value</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Write to a register of an I2C module.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd><ul>
<li>
Only the 7 least significant bits of mod_addr and mod_reg are used.  </li>
</ul>
</dd></dl>
<dl compact><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Check that timeout is really implemented in both Windows and POSIX.</dd></dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>
0 : success  </li>
<li>
-1 : write error  </li>
<li>
-2 : couldn't drain port  </li>
<li>
-3 : write timeout  </li>
</ul>
</dd></dl>
<dl compact><dt><b>Parameters: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em>handle</em>&nbsp;</td><td>
file descriptor </td></tr>
<tr><td valign="top"><em>mod_addr</em>&nbsp;</td><td>
i2c address of module </td></tr>
<tr><td valign="top"><em>mod_reg</em>&nbsp;</td><td>
address of register inside module </td></tr>
<tr><td valign="top"><em>value</em>&nbsp;</td><td>
value to be written </td></tr>
</table>
</dl>
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Thu May 31 20:35:32 2007 for ERAEmbeddedRobotArmProject by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
